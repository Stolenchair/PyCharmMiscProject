# Инструкция по настройке колонок Excel

Если при загрузке данных вы видите неправильные значения (например, название организации вместо населенного пункта), вам нужно проверить настройки колонок в файле `prg_settings.json`.

## Как исправить настройки

1. Откройте файл `prg_settings.json` в текстовом редакторе
2. Найдите секцию `"prg"` - это настройки для листа ПРГ
3. Проверьте следующие параметры:

```json
"prg": {
  "sheet": "ПРГ",           // Название листа с данными ПРГ
  "start_row": "3",         // С какой строки начинаются данные
  "mo_col": "E",            // Колонка с РАЙОНОМ (МО)
  "settlement_col": "D",    // Колонка с НАСЕЛЕННЫМ ПУНКТОМ
  "prg_id_col": "A",        // Колонка с ID ПРГ
  "grs_id_col": "AH"        // Колонка с ID ГРС
}
```

## Как определить правильные колонки

1. Откройте ваш Excel файл
2. Перейдите на лист "ПРГ"
3. Посмотрите на заголовки колонок:
   - Найдите колонку с **ID ПРГ** (обычно A, B или C)
   - Найдите колонку с **Районом** (например, "Гиагинский район")
   - Найдите колонку с **Населенным пунктом** (например, "с. Гончарка", "п. Каменномостский")
   - Найдите колонку с **ID ГРС**

4. Запишите буквы колонок (A, B, C, D, E и т.д.)
5. Обновите значения в `prg_settings.json`

## Пример проблемы

**Ошибка:** "В населенном пункте 'Агрокормсервис плюс ООО' района 'Гиагинский район' нет потребителей"

**Причина:** В колонке D находится название организации, а не населенный пункт

**Решение:**
- Найдите в Excel, в какой колонке находится настоящий населенный пункт (например, колонка C)
- Измените в `prg_settings.json`: `"settlement_col": "C"`

## Аналогично для других секций

### Секция "population" (Население)
```json
"population": {
  "sheet": "Связь со схемой - Население",
  "start_row": "10",
  "mo_col": "B",            // Колонка с районом
  "settlement_col": "C",    // Колонка с НП
  "code_col": "M",          // Колонка с привязками ПРГ
  "expenses_col": "I",      // Колонка с годовыми расходами
  "hourly_expenses_col": "J" // Колонка с часовыми расходами
}
```

### Секция "organizations" (Организации)
```json
"organizations": {
  "sheet": "Связь со схемой - Организации",
  "start_row": "10",
  "name_col": "E",          // Колонка с названием организации
  "mo_col": "C",            // Колонка с районом
  "settlement_col": "D",    // Колонка с НП
  "code_col": "M",          // Колонка с привязками ПРГ
  "expenses_col": "J",      // Колонка с годовыми расходами
  "hourly_expenses_col": "K", // Колонка с часовыми расходами
  "grs_id_col": "L"         // Колонка с ID ГРС
}
```

## Отладка

При загрузке файла в консоли приложения выводятся первые 3 записи ПРГ. Проверьте, что:
- В поле "Район (МО)" отображается название района
- В поле "НП" отображается название населенного пункта (а не организации!)
- В поле "ПРГ ID" отображается корректный ID ПРГ

Если данные неправильные - исправьте настройки колонок!
